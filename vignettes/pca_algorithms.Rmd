---
title: "pca.svd, pca.svdw, pca.eigen, pca.nipals"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{pca.svd, pca.svdw, pca.eigen, pca.nipals}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE) 
```

```{r, message = FALSE, warning = FALSE}

library(rnirs)             

```

```{r}

n <- 6
p <- 4
set.seed(1)
X <- matrix(rnorm(n * p, mean = 10), ncol = p, byrow = TRUE)
set.seed(NULL)
X

pca.svd(X, ncomp = 3)
pca.eigen(X, ncomp = 3)
pca.nipals(X, ncomp = 3)

pca.svdw(X, ncomp = 3, weights = rep(1, n))

```

## WITH MISSING DATA

```{r}

X2 <- X
X2[3, 3] <- X2[1, 3] <- X2[1, 2] <- NA
X2

fm <- pca.nipals(X2, ncomp = 3)
fm

```

Replacement of the missing data in matrix *X2* by their NIPALS estimates

```{r}

Xhat <- xfit(fm$T, fm$P, fm$xmeans)
Xhat
u <- which(is.na(X2))
Xfull <- replace(X2, u, Xhat[u])
Xfull

```



